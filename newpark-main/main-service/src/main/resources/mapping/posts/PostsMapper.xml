<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newpark.main.service.posts.mapper.PostsMapper">

    <sql id="ALL">
        SELECT t_id,
               t_title,
               t_context,
               t_pub_time,
               t_last_time,
               t_author_id,
               t1.u_nikname,
               t1.u_path,
               t_like_count,
               t_forward_count,
               t_type_id,
               t_com_count,
               t.school_id
        FROM posts t LEFT JOIN usr_info t1 ON t.t_author_id = t1.info_id
    </sql>

    <sql id="ALLLABLE">
        SELECT t_id,
               t_title,
               t_context,
               t_pub_time,
               t_last_time,
               t_author_id,
               t_like_count,
               t_com_count,
               t_forward_count,
               t_browse_count,
               t_type_id,
               t_classify_id,
               school_id,
               t1.lable_text
        FROM posts t
                 LEFT JOIN posts_lable t1 ON t.t_id = t1.posts_id
    </sql>

    <select id="getPostsFindALL" parameterType="com.newpark.main.service.entity.vo.PostParamVo"
            resultType="com.newpark.main.service.entity.dto.PostsDto">
        <include refid="ALL"></include>
        <where>
            <if test="schoolId != null and schoolId != ''">
                t.school_id = #{schoolId}
            </if>
        </where>
    </select>

</mapper>
